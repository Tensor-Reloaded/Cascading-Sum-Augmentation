<!DOCTYPE html>
    <html>
    <head>
        <meta charset="UTF-8">
        <title>Cascading Sum Augmentation</title>
        
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
        
        <style>
.task-list-item { list-style-type: none; } .task-list-item-checkbox { margin-left: -20px; vertical-align: middle; }
</style>
        <style>
            body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', 'Ubuntu', 'Droid Sans', sans-serif;
                font-size: 14px;
                line-height: 1.6;
            }
        </style>
        
        
    </head>
    <body class="vscode-light">
        <h1 id="cascading-sum-augmentation">Cascading Sum Augmentation</h1>
<p>This is the official repository for the source code and experiments for Cascading Sum Augmentation <a href="">add link to paper</a> by Cristian Simionescu, Robert Herscovici and Cosmin Pascaru</p>
<p>The reporsitory contains a PyTorch implementation of our technique and the experiment results contained in TensorBoard log files. Download links for some of the experiment trained weights are also provided. These can be found in the &quot;runs/&quot; folder, each run will contain a README with the command used to obtain the result and the best test accuracy obtained with it.</p>
<p>To run the experiments yourself you will require to install PyTorch&gt;=1.2.0, TorchVision=0.4.0, NumPy&gt;=1.16.3 and tb-nightly==1.15.0a20190825.</p>
<p>Recent advances in Deep Learning have greatly improved performance on various Computer Vision tasks,including classification, object detection and image segmentation. However, training Deep Artificial Neural Networks requires a substantial amount of labeled data, which may prove costly or impractically hard to obtain, especially in certain domains such as robotics or medicine. This makes the search for ways to artificially augment the data we have in order to obtain more generalized models a worthwhile endeavor. One very important argument is that security is extremely relevant in todayâ€™s world, and neural networks with superior generalization power not only produce better results, but they are also more resistant to adversarial attacks. Many data augmentation techniques have been proposed, each with various degrees of success and use cases, depending on the data sets, models and machine learning techniques used. They are at theheart of many applications, ranging from image classification to speech recognition. The majority of data augmentation algorithms used result in images that are understandable and can be correctly identified by a human observer e.g. horizontal/vertical flipping, cropping, rotation, brightness adjustments or even random erasing.</p>
<p>Cascading Sum Augmentation is a method of successfully training deep neural networks using linear combinations of arbitarly many inputs achiving a significant gain in test accuracy and an increase in robustness towards adversarial attacks.</p>
<p>The underling technique used is called Sum Augmentation, which creates the overlaped images and associated labels, Cascading Sum Augmentation uses this method as a subroutine. Starting from an example K=8 number of inputs that are combined to generate the augmented data we train our model untill it platoues, then we load the best performing checkpoint we have and restart the training with K=4, repeat untill K=1. When K=1 we are effectively training on the original dataset.</p>
<h3 id="k2-images">K=2 images</h3>
<p float="left">
  <img src="file:///c:\Users\Cristian\Desktop\Research\Cascading Sum Augmentation\example_images\sum_aug\sum_groups_2_0.png" width="44" />
  <img src="file:///c:\Users\Cristian\Desktop\Research\Cascading Sum Augmentation\example_images\sum_aug\sum_groups_2_1.png" width="44" />
  <img src="file:///c:\Users\Cristian\Desktop\Research\Cascading Sum Augmentation\example_images\sum_aug\sum_groups_2_2.png" width="44" />
  <img src="file:///c:\Users\Cristian\Desktop\Research\Cascading Sum Augmentation\example_images\sum_aug\sum_groups_2_3.png" width="44" />
  <img src="file:///c:\Users\Cristian\Desktop\Research\Cascading Sum Augmentation\example_images\sum_aug\sum_groups_2_4.png" width="44" />
  <img src="file:///c:\Users\Cristian\Desktop\Research\Cascading Sum Augmentation\example_images\sum_aug\sum_groups_2_5.png" width="44" />
  <img src="file:///c:\Users\Cristian\Desktop\Research\Cascading Sum Augmentation\example_images\sum_aug\sum_groups_2_6.png" width="44" />
  <img src="file:///c:\Users\Cristian\Desktop\Research\Cascading Sum Augmentation\example_images\sum_aug\sum_groups_2_7.png" width="44" />
  <img src="file:///c:\Users\Cristian\Desktop\Research\Cascading Sum Augmentation\example_images\sum_aug\sum_groups_2_8.png" width="44" />
  <img src="file:///c:\Users\Cristian\Desktop\Research\Cascading Sum Augmentation\example_images\sum_aug\sum_groups_2_9.png" width="44" />
</p>
<h3 id="k4-images">K=4 images</h3>
<p float="left">
  <img src="file:///c:\Users\Cristian\Desktop\Research\Cascading Sum Augmentation\example_images\sum_aug\sum_groups_4_0.png" width="44" />
  <img src="file:///c:\Users\Cristian\Desktop\Research\Cascading Sum Augmentation\example_images\sum_aug\sum_groups_4_1.png" width="44" />
  <img src="file:///c:\Users\Cristian\Desktop\Research\Cascading Sum Augmentation\example_images\sum_aug\sum_groups_4_2.png" width="44" />
  <img src="file:///c:\Users\Cristian\Desktop\Research\Cascading Sum Augmentation\example_images\sum_aug\sum_groups_4_3.png" width="44" />
  <img src="file:///c:\Users\Cristian\Desktop\Research\Cascading Sum Augmentation\example_images\sum_aug\sum_groups_4_4.png" width="44" />
  <img src="file:///c:\Users\Cristian\Desktop\Research\Cascading Sum Augmentation\example_images\sum_aug\sum_groups_4_5.png" width="44" />
  <img src="file:///c:\Users\Cristian\Desktop\Research\Cascading Sum Augmentation\example_images\sum_aug\sum_groups_4_6.png" width="44" />
  <img src="file:///c:\Users\Cristian\Desktop\Research\Cascading Sum Augmentation\example_images\sum_aug\sum_groups_4_7.png" width="44" />
  <img src="file:///c:\Users\Cristian\Desktop\Research\Cascading Sum Augmentation\example_images\sum_aug\sum_groups_4_8.png" width="44" />
  <img src="file:///c:\Users\Cristian\Desktop\Research\Cascading Sum Augmentation\example_images\sum_aug\sum_groups_4_9.png" width="44" />
</p>
<h3 id="k8-images">K=8 images</h3>
<p float="left">
  <img src="file:///c:\Users\Cristian\Desktop\Research\Cascading Sum Augmentation\example_images\sum_aug\sum_groups_8_0.png" width="44" />
  <img src="file:///c:\Users\Cristian\Desktop\Research\Cascading Sum Augmentation\example_images\sum_aug\sum_groups_8_1.png" width="44" />
  <img src="file:///c:\Users\Cristian\Desktop\Research\Cascading Sum Augmentation\example_images\sum_aug\sum_groups_8_2.png" width="44" />
  <img src="file:///c:\Users\Cristian\Desktop\Research\Cascading Sum Augmentation\example_images\sum_aug\sum_groups_8_3.png" width="44" />
  <img src="file:///c:\Users\Cristian\Desktop\Research\Cascading Sum Augmentation\example_images\sum_aug\sum_groups_8_4.png" width="44" />
  <img src="file:///c:\Users\Cristian\Desktop\Research\Cascading Sum Augmentation\example_images\sum_aug\sum_groups_8_5.png" width="44" />
  <img src="file:///c:\Users\Cristian\Desktop\Research\Cascading Sum Augmentation\example_images\sum_aug\sum_groups_8_6.png" width="44" />
  <img src="file:///c:\Users\Cristian\Desktop\Research\Cascading Sum Augmentation\example_images\sum_aug\sum_groups_8_7.png" width="44" />
  <img src="file:///c:\Users\Cristian\Desktop\Research\Cascading Sum Augmentation\example_images\sum_aug\sum_groups_8_8.png" width="44" />
  <img src="file:///c:\Users\Cristian\Desktop\Research\Cascading Sum Augmentation\example_images\sum_aug\sum_groups_8_9.png" width="44" />
</p>
<p>You can see the results of using Cascading Sum Augmentation with various start values for K on CIFAR-10 and CIFAR-100. In the table you can also see the results of our method on subsets of the original datasets. We trained on WideResNet(40,4) and WideResNet(28,10) you will find complete TensorBoard logs for these runs in the &quot;runs&quot; folder.</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Starting Sum Groups (K)</td>
<td style="text-align:center"></td>
<td style="text-align:center">WideResNet(40,4)</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center">WideResNet(28,10)</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">100</td>
<td style="text-align:center">500</td>
<td style="text-align:center">5000</td>
<td style="text-align:center">100</td>
<td style="text-align:center">500</td>
<td style="text-align:center">5000</td>
<td style="text-align:center">(Samples/Class)</td>
</tr>
<tr>
<td style="text-align:center">8</td>
<td style="text-align:center">31.19%</td>
<td style="text-align:center">13.51%</td>
<td style="text-align:center">4.02%</td>
<td style="text-align:center"><strong>29.34%</strong></td>
<td style="text-align:center">13.21%</td>
<td style="text-align:center">3.28%</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center"><strong>30.65%</strong></td>
<td style="text-align:center"><strong>13.29%</strong></td>
<td style="text-align:center"><strong>3.88%</strong></td>
<td style="text-align:center">30.36%</td>
<td style="text-align:center"><strong>12.81%</strong></td>
<td style="text-align:center"><strong>3.11%</strong></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">32.44%</td>
<td style="text-align:center">14.88%</td>
<td style="text-align:center">5.53%</td>
<td style="text-align:center">30.99%</td>
<td style="text-align:center">13.1%</td>
<td style="text-align:center">3.44%</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">Baseline</td>
<td style="text-align:center">47.36%</td>
<td style="text-align:center">20.15%</td>
<td style="text-align:center">5.57%</td>
<td style="text-align:center">43.47%</td>
<td style="text-align:center">19.96%</td>
<td style="text-align:center">4.68%</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Starting Sum Groups (K)</td>
<td style="text-align:center"></td>
<td style="text-align:center">WideResNet(40,4)</td>
<td style="text-align:center"></td>
<td style="text-align:center">WideResNet(28,10)</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">100</td>
<td style="text-align:center">500</td>
<td style="text-align:center">100</td>
<td style="text-align:center">500</td>
<td style="text-align:center">(Samples/Class)</td>
</tr>
<tr>
<td style="text-align:center">8</td>
<td style="text-align:center">35.3%</td>
<td style="text-align:center">20.34%</td>
<td style="text-align:center">35.01%</td>
<td style="text-align:center">18.63%</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center"><strong>34.7%</strong></td>
<td style="text-align:center"><strong>19.85%</strong></td>
<td style="text-align:center"><strong>33.01%</strong></td>
<td style="text-align:center"><strong>18.09%</strong></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">35.56%</td>
<td style="text-align:center">20.17%</td>
<td style="text-align:center">34.44%</td>
<td style="text-align:center">18.17%</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">Baseline</td>
<td style="text-align:center">43.2%</td>
<td style="text-align:center">23.87%</td>
<td style="text-align:center">41.72%</td>
<td style="text-align:center">21.94%</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<p>See [add link to article](link to article) for more information and results.</p>
<h2 id="test-time-sum-augmentation">Test Time Sum Augmentation</h2>
<p>This is a method simply applies Sum Augmentation when we want to classify a batch of images. The method generates multiple linear combinations from the data we want tested and does forward passes in the network. Then we calculate the average score for each output in order to calculate the actual label of our data.</p>
<p>The technique drastically improves accuracy for models which had the cascading training method stopped at K=2, meaning the model never saw any &quot;clean&quot; data.
And while the scores are lower than the models which had the final fine-tune step of training on original data, using Test Time Augmentation improves the robustness to adversarial attacks. This method offers a way to make trade-offs between better generalization and robustness.</p>
<table>
<thead>
<tr>
<th style="text-align:left"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Values for K</td>
<td style="text-align:center"></td>
<td style="text-align:center">WideResNet(40,4)</td>
<td style="text-align:center"></td>
<td style="text-align:center">WideResNet(28,10)</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:center">Normal Test</td>
<td style="text-align:center">Test Time Sum Augmentation</td>
<td style="text-align:center">Normal Test</td>
<td style="text-align:center">Test Time Sum Augmentation</td>
</tr>
<tr>
<td style="text-align:left">8-4-2</td>
<td style="text-align:center">6.53%</td>
<td style="text-align:center">6.32%</td>
<td style="text-align:center">5.58%</td>
<td style="text-align:center">5.11%</td>
</tr>
<tr>
<td style="text-align:left">4-2</td>
<td style="text-align:center">6.91%</td>
<td style="text-align:center">6.32%</td>
<td style="text-align:center">5.35%</td>
<td style="text-align:center"><strong>5.09%</strong></td>
</tr>
<tr>
<td style="text-align:left">2</td>
<td style="text-align:center">6.19%</td>
<td style="text-align:center"><strong>6.03%</strong></td>
<td style="text-align:center">5.74%</td>
<td style="text-align:center">5.39%</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:left"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Values for K</td>
<td style="text-align:center"></td>
<td style="text-align:center">WideResNet(40,4)</td>
<td style="text-align:center"></td>
<td style="text-align:center">WideResNet(28,10)</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:center">Normal Test</td>
<td style="text-align:center">Test Time Sum Augmentation</td>
<td style="text-align:center">Normal Test</td>
<td style="text-align:center">Test Time Sum Augmentation</td>
</tr>
<tr>
<td style="text-align:left">8-4-2</td>
<td style="text-align:center">27.18%</td>
<td style="text-align:center">24.06%</td>
<td style="text-align:center">25.11%</td>
<td style="text-align:center"><strong>20.25%</strong></td>
</tr>
<tr>
<td style="text-align:left">4-2</td>
<td style="text-align:center">27.22%</td>
<td style="text-align:center">23.9%</td>
<td style="text-align:center">24.42%</td>
<td style="text-align:center">20.46%</td>
</tr>
<tr>
<td style="text-align:left">2</td>
<td style="text-align:center">27.19%</td>
<td style="text-align:center"><strong>23.58%</strong></td>
<td style="text-align:center">24.32%</td>
<td style="text-align:center">20.29%</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<h2 id="reference">Reference</h2>
<p>Please use the following bibtex to reference our work:</p>
<pre><code><div>@INPROCEEDINGS{CascadingSumAugmentation,
    author = {Simionescu, Herscovici &amp; Pascaru},
    title = {Cascading Sum Augmentation},
    booktitle = {BMVC},
    year = {2019}}
</div></code></pre>
<h2 id="license">License</h2>
<p>This project is licensed under the Academic Free License (AFL) v. 3.0 - see the [<a href="http://LICENSE.md">LICENSE.md</a>](<a href="http://LICENSE.md">LICENSE.md</a>) file for details</p>
<h2 id="acknowledgments">Acknowledgments</h2>
<ul>
<li>Hat tip to anyone whose code was used</li>
<li>Inspiration</li>
<li>etc</li>
</ul>

    </body>
    </html>